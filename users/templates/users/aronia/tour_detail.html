{% load static %}

<style>
    /* Tour Detail Page Styles */
.place-details-section {
    padding: 60px 0;
    background-color: #2c5986;
}

/* Place Slider Styles */
.place-slider-area {
    margin-bottom: 40px;
}

.place-slider {
    position: relative;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.place-img {
    height: 500px;
    overflow: hidden;
}

.place-img img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* Tour Title Wrapper */
.tour-title-wrapper {
    background: #fff;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    margin-bottom: 30px;
}

.tour-title h3 {
    font-size: 28px;
    font-weight: 700;
    color: #333;
    margin-bottom: 10px;
}

.tour-title p {
    color: #666;
    font-size: 16px;
}

.tour-widget-info {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
}

.info-box {
    flex: 1;
    min-width: 200px;
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    gap: 15px;
}

.info-box .icon {
    width: 50px;
    height: 50px;
    background: #fff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.info-box .icon i {
    font-size: 20px;
    color: #007bff;
}

.info-box .info h4 {
    margin: 0;
    font-size: 16px;
}

.info-box .info h4 span {
    display: block;
    font-size: 14px;
    color: #666;
    margin-bottom: 5px;
}

/* Ratings Box */
.ratings-box {
    display: flex;
    align-items: center;
    gap: 10px;
}

.ratings {
    display: flex;
    gap: 5px;
    margin: 0;
    padding: 0;
    list-style: none;
}

.ratings li i {
    color: #ffc107;
}

.ratings li a {
    color: #666;
    text-decoration: none;
    margin-left: 10px;
}

/* Place Content */
.place-content-wrap {
    background: #fff;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    margin-bottom: 30px;
}

.place-content-wrap h3 {
    font-size: 24px;
    margin-bottom: 20px;
    color: #333;
}

.place-content-wrap p {
    color: #666;
    line-height: 1.8;
    margin-bottom: 20px;
}

.check-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.check-list li {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
    color: #666;
}

.check-list li i {
    color: #28a745;
}

/* Days Area */
.days-area {
    background: #fff;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.days-area h4 {
    font-size: 24px;
    margin-bottom: 20px;
    color: #333;
}

.accordion-item {
    border: none;
    margin-bottom: 10px;
    border-radius: 8px !important;
    overflow: hidden;
}

.accordion-button {
    background: #f8f9fa;
    border: none;
    padding: 15px 20px;
    font-weight: 600;
}

.accordion-button:not(.collapsed) {
    background: #007bff;
    color: #fff;
}

.accordion-body {
    padding: 20px;
    background: #fff;
}

/* Included Wrapper */
.included-wrapper {
    background: #fff;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.included-wrapper h4 {
    font-size: 24px;
    margin-bottom: 20px;
    color: #333;
}

.included-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.included-list li {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
    color: #666;
}

.included-list li i.fa-check {
    color: #28a745;
}

.included-list li i.fa-times {
    color: #dc3545;
}

/* Reviews Area */
.reviews-wrapper {
    background: #fff;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.reviews-wrapper h3 {
    font-size: 24px;
    margin-bottom: 20px;
    color: #333;
}

.review-item {
    padding: 20px;
    border-bottom: 1px solid #eee;
}

.review-item:last-child {
    border-bottom: none;
}

.reviewer-info {
    margin-bottom: 15px;
}

.reviewer-info h4 {
    font-size: 18px;
    margin-bottom: 5px;
    color: #333;
}

.reviewer-info .date {
    color: #666;
    font-size: 14px;
}

.rating-categories {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-top: 10px;
}

.rating-categories span {
    color: #666;
    font-size: 14px;
}

/* Booking Widget */
.sidebar-widget-area {
    position: sticky;
    top: 30px;
}

.booking-form-widget {
    background: #fff;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.booking-form-widget h4 {
    font-size: 24px;
    margin-bottom: 20px;
    color: #333;
}

.booking-item {
    margin-bottom: 20px;
}

.booking-item label {
    display: block;
    margin-bottom: 8px;
    color: #666;
    font-weight: 500;
}

.bk-item input {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 14px;
}

.booking-total {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 20px;
}

.booking-total .total {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.booking-total label {
    color: #666;
    font-weight: 500;
}

.booking-total .price {
    font-size: 20px;
    font-weight: 700;
    color: #007bff;
}

.submit-button button {
    width: 100%;
    padding: 15px;
    background: #007bff;
    color: #fff;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
}

.submit-button button:hover {
    background: #0056b3;
}

.submit-button button i {
    margin-left: 8px;
}

/* Responsive Design */
@media (max-width: 991px) {
    .place-img {
        height: 400px;
    }
    
    .tour-widget-info {
        margin-top: 20px;
    }
    
    .info-box {
        min-width: 100%;
    }
}

@media (max-width: 767px) {
    .place-img {
        height: 300px;
    }
    
    .tour-title h3 {
        font-size: 24px;
    }
    
    .sidebar-widget-area {
        margin-top: 30px;
    }
}
</style>

{% block content %}
<section class="place-details-section">
    <!--=== Place Slider ===-->
    <div class="place-slider-area overflow-hidden wow fadeInUp">
        <div class="place-slider">
            <div class="place-slider-item">
                {% if tour.Image %}
                    <div class="place-img">
                        <img src="{{ tour.Image.cdn_url }}" alt="{{ tour.name }}">
                    </div>
                {% endif %}
            </div>
            {% if tour.gallery_image1 %}
            <div class="place-slider-item">
                <div class="place-img">
                    <img src="{{ tour.gallery_image1.cdn_url }}" alt="{{ tour.name }} Gallery 1">
                </div>
            </div>
            {% endif %}
            {% if tour.gallery_image2 %}
            <div class="place-slider-item">
                <div class="place-img">
                    <img src="{{ tour.gallery_image2.cdn_url }}" alt="{{ tour.name }} Gallery 2">
                </div>
            </div>
            {% endif %}
            {% if tour.gallery_image3 %}
            <div class="place-slider-item">
                <div class="place-img">
                    <img src="{{ tour.gallery_image3.cdn_url }}" alt="{{ tour.name }} Gallery 3">
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    <div class="container">
        <!--=== Tour Details Wrapper ===-->
        <div class="tour-details-wrapper pt-80">
            <!--=== Tour Title Wrapper ===-->
            <div class="tour-title-wrapper pb-30 wow fadeInUp">
                <div class="row">
                    <div class="col-xl-6">
                        <div class="tour-title mb-20">
                            <h3 class="title">{{ tour.name }}</h3>
                            <p><i class="far fa-map-marker-alt"></i>{{ tour.destination.name }}</p>
                        </div>
                    </div>
                    <div class="col-xl-6">
                        <div class="tour-widget-info">
                            <div class="info-box mb-20">
                                <div class="icon">
                                    <i class="fal fa-box-usd"></i>
                                </div>
                                <div class="info">
                                    <h4><span>From</span>KES {{ tour.price }}</h4>
                                </div>
                            </div>
                            <div class="info-box mb-20">
                                <div class="icon">
                                    <i class="fal fa-clock"></i>
                                </div>
                                <div class="info">
                                    <h4><span>Duration</span>{{ tour.duration }} Days</h4>
                                </div>
                            </div>
                            <div class="info-box mb-20">
                                <div class="icon">
                                    <i class="fal fa-users"></i>
                                </div>
                                <div class="info">
                                    <h4><span>Group Size</span>{{ tour.group_size }} People</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--=== Tour Area Nav ===-->
            <div class="tour-area-nav pt-20 pb-20 wow fadeInUp">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <div class="ratings-box">
                            <ul class="ratings">
                                {% for i in "12345"|make_list %}
                                    {% if forloop.counter <= tour.rating %}
                                        <li><i class="fas fa-star"></i></li>
                                    {% else %}
                                        <li><i class="far fa-star"></i></li>
                                    {% endif %}
                                {% endfor %}
                                <li><a href="#reviews">({{ tour.reviews_count }} Reviews)</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-xl-8">
                    <!--=== Place Content Wrap ===-->
                    <div class="place-content-wrap pt-45 wow fadeInUp">
                        <h3 class="title">Tour Overview</h3>
                        <p>{{ tour.description }}</p>
                        
                        <h4>Tour Highlights</h4>
                        <ul class="check-list">
                            {% for highlight in tour.highlights.all %}
                            <li><i class="fas fa-badge-check"></i>{{ highlight.highlight }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    
                    <!--=== Days Area ===-->
                    <div class="days-area mb-55 wow fadeInUp">
                        <h4>Tour Itinerary</h4>
                        <div class="accordion" id="tourDays">
                            {% for day in tour.tour_days.all %}
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button {% if not forloop.first %}collapsed{% endif %}" type="button" data-bs-toggle="collapse" data-bs-target="#day{{ day.day_number }}">
                                        Day {{ day.day_number }}: {{ day.title }}
                                    </button>
                                </h2>
                                <div id="day{{ day.day_number }}" class="accordion-collapse collapse {% if forloop.first %}show{% endif %}" data-bs-parent="#tourDays">
                                    <div class="accordion-body">
                                        {{ day.description }}
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                    <!--=== What's Included ===-->
                    <div class="included-wrapper mb-50 wow fadeInUp">
                        <h4>What's Included/Excluded</h4>
                        <ul class="included-list">
                            {% for inclusion in tour.inclusions.all %}
                            <li>
                                {% if inclusion.is_included %}
                                <i class="fas fa-check"></i>
                                {% else %}
                                <i class="fas fa-times"></i>
                                {% endif %}
                                {{ inclusion.item }}
                            </li>
                            {% endfor %}
                        </ul>
                    </div>

                    <!--=== Reviews Area ===-->
                    <div id="reviews" class="reviews-wrapper mb-60 wow fadeInUp">
                        <h3>Customer Reviews</h3>
                        {% for review in tour.reviews.all %}
                        <div class="review-item mb-30">
                            <div class="review-content">
                                <div class="reviewer-info">
                                    <h4>{{ review.user_name }}</h4>
                                    <span class="date">{{ review.created_at|date:"F d, Y" }}</span>
                                    <div class="ratings">
                                        {% for i in "12345"|make_list %}
                                            {% if forloop.counter <= review.rating %}
                                                <i class="fas fa-star"></i>
                                            {% else %}
                                                <i class="far fa-star"></i>
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                </div>
                                <p>{{ review.comment }}</p>
                                <div class="rating-categories">
                                    <span>Location: {{ review.location_rating }}/5</span>
                                    <span>Price: {{ review.price_rating }}/5</span>
                                    <span>Amenities: {{ review.amenities_rating }}/5</span>
                                    <span>Services: {{ review.services_rating }}/5</span>
                                    <span>Rooms: {{ review.rooms_rating }}/5</span>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="col-xl-4">
                    <!--=== Sidebar Widget Area ===-->
                    <div class="sidebar-widget-area pt-60 pl-lg-30">
                        <!--=== Booking Widget ===-->
                        <div class="sidebar-widget booking-form-widget wow fadeInUp mb-40">
                            <h4 class="widget-title">Book This Tour</h4>
                            <form method="post" action="{% url 'dede:tour_booking' tour.slug %}" class="sidebar-booking-form">
                                {% csrf_token %}
                                <div class="booking-item mb-20">
                                    <label>Travel Date</label>
                                    <div class="bk-item">
                                        <input type="date" name="travel_date" required>
                                    </div>
                                </div>
                                <div class="booking-item mb-20">
                                    <label>Number of People</label>
                                    <div class="bk-item">
                                        <input type="number" name="number_of_people" min="1" max="{{ tour.group_size }}" required>
                                    </div>
                                </div>
                                <div class="booking-total mb-20">
                                    <div class="total">
                                        <label>Price per person</label>
                                        <span class="price">KES {{ tour.price }}</span>
                                    </div>
                                </div>
                                <div class="submit-button">
                                    <button type="submit" class="main-btn primary-btn">Book Now<i class="far fa-paper-plane"></i></button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}